<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Math Model Leaderboard</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />


  <style>
    .group-header {
      font-weight: bold;
      background-color: #e5e7eb !important;
      text-align: left;
    }
    .highlight-row {
      background-color: #fef3c7 !important;
    }
    .model-name {
      font-weight: 500;
    }
    .best-score {
      font-weight: bold;
      color: #047857;
    }
    .dataTables_wrapper .dataTables_filter {
      float: none;
      text-align: left;
      margin-bottom: 1rem;
    }
    .dataTables_wrapper .dataTables_length,
    .dataTables_wrapper .dataTables_filter {
      margin-bottom: 1rem;
    }
    .dataTables_wrapper .dataTables_info {
      padding-top: 0.5rem;
    }
    .dataTables_wrapper .dataTables_filter {
    margin: 0;
    float: none;
    }


    #groupFilterContainer {
      margin-bottom: 1rem;
    }
  </style>
</head>
<body class="bg-white text-gray-900 p-6">
  <div class="max-w-7xl mx-auto">
    <!-- Heading and buttons section -->
    <div class="text-center mb-6">
    <h1 class="text-3xl font-bold mb-4">Sober Reasoning Leaderboard</h1>
    <p class="text-sm text-gray-700 mb-4 max-w-2xl mx-auto">
        Evaluation reports Pass@1 accuracy (mean ± std) across six math benchmarks using standardized evaluation (LightEval). Averages are automatically computed.
    </p>
    <div class="flex justify-center gap-4 mb-6 flex-wrap">
        <a href="https://your-paper-link.com" target="_blank"
        class="px-4 py-2 flex items-center gap-2 bg-pink-100 text-pink-800 text-sm rounded hover:bg-pink-200 transition border border-pink-200 shadow-sm">
        <i class="fas fa-file-alt"></i>
        Paper
        </a>
        <a href="https://your-code-link.com" target="_blank"
        class="px-4 py-2 flex items-center gap-2 bg-blue-100 text-blue-800 text-sm rounded hover:bg-blue-200 transition border border-blue-200 shadow-sm">
        <i class="fab fa-github"></i>
        Code
        </a>
    </div>
    </div>


<!-- Unified controls bar -->
<div id="controlsBar" class="flex flex-wrap items-end justify-between gap-4 mb-6">
    <!-- Filter dropdown -->
    <div class="flex flex-col">
      <label for="groupFilter" class="text-sm font-medium text-gray-700 mb-1">Filter by Model Group:</label>
      <select id="groupFilter" class="border border-gray-300 rounded px-3 py-2 w-64">
        <option value="">All model groups</option>
      </select>
    </div>
  
    <!-- Highlight buttons -->
    <div class="flex gap-2">
      <button id="highlightBest" class="px-3 py-2 bg-green-100 text-green-800 rounded hover:bg-green-200 text-sm border border-green-200 shadow-sm">
        Highlight Best
      </button>
      <button id="resetHighlights" class="px-3 py-2 bg-yellow-100 text-yellow-800 rounded hover:bg-yellow-200 text-sm border border-yellow-200 shadow-sm">
        Reset
      </button>
    </div>
  
    <!-- Placeholder for search bar -->
    <div id="customSearchContainer" class="ml-auto"></div>
  </div>
  
  

    <!-- Table -->
    <div class="overflow-x-auto shadow-md rounded-lg">
      <table id="modelTable" class="display stripe w-full text-sm">
        <thead>
          <tr>
            <th>Model Name</th>
            <th>Organization</th>
            <th>Based on</th>
            <th>Paper Link</th>
            <th>AIME'24</th>
            <th>AIME'25</th>
            <th>AMC'23</th>
            <th>MATH500</th>
            <th>Minerva</th>
            <th>Olympiad</th>
            <th>Average</th>
          </tr>
        </thead>
        <tbody id="modelBody">
          <!-- Populated dynamically -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    $.getJSON("data.json", function(modelData) {
      const tbody = $("#modelBody");
      const groups = new Set();

      modelData.forEach(model => {
        groups.add(model.basedOn);

        const scores = [
          model.aime24,
          model.aime25,
          model.amc23,
          model.math500,
          model.minerva,
          model.olympiad
        ];

        const avg =
          scores
            .map(s => parseFloat(s.split("±")[0]))
            .filter(n => !isNaN(n))
            .reduce((a, b) => a + b, 0) / scores.length;

        const row = $("<tr>")
          .addClass("group-row")
          .attr("data-group", model.basedOn);
        row.append(`<td class="model-name">${model.name}</td>`);
        row.append(`<td>${model.organization}</td>`);
        row.append(`<td>${model.basedOn}</td>`);
        row.append(`<td><a href="${model.paperLink}" target="_blank">${model.paperText}</a></td>`);
        row.append(`<td>${model.aime24}</td>`);
        row.append(`<td>${model.aime25}</td>`);
        row.append(`<td>${model.amc23}</td>`);
        row.append(`<td>${model.math500}</td>`);
        row.append(`<td>${model.minerva}</td>`);
        row.append(`<td>${model.olympiad}</td>`);
        row.append(`<td>${avg.toFixed(1)}</td>`);
        tbody.append(row);
      });

      groups.forEach(group => {
        $("#groupFilter").append(`<option value="${group}">${group}</option>`);
      });

      initTable();
    });

    function initTable() {
      const table = $('#modelTable').DataTable({
        columnDefs: [
          {
            targets: [4, 5, 6, 7, 8, 9, 10],
            render: function (data, type) {
              if (type === 'sort' || type === 'type') {
                return parseFloat(data.split('±')[0]);
              }
              return data;
            }
          }
        ],
        order: [[2, 'asc'], [10, 'desc']],
        rowGroup: {
          dataSrc: 2,
          startRender: function (rows, group) {
            return $('<tr class="group-header"/>')
              .append(`<td colspan="10">Based on: ${group}</td>`);
          }
        },
        paging: false,
        info: true,
        ordering: true,
        searching: true
      });
      // Move the search bar into our custom flex container
        $('#customSearchContainer').append($('#modelTable_filter'));
        $('#modelTable_filter label').addClass('flex items-center gap-2');
        $('#modelTable_filter input').addClass('px-3 py-2 border border-gray-300 rounded bg-white text-sm shadow-sm w-64');


      $('#groupFilter').on('change', function () {
        const val = $(this).val();
        table.column(2).search(val, false, false).draw();
      });

      $('#highlightBest').on('click', function () {
        $('.best-score').removeClass('best-score');
        for (let col = 4; col <= 9; col++) {
          let bestScore = -1;
          let bestIdx = -1;
          table.rows({ search: 'applied' }).every(function (idx) {
            const score = parseFloat(this.data()[col].split('±')[0]);
            if (!isNaN(score) && score > bestScore) {
              bestScore = score;
              bestIdx = idx;
            }
          });
          if (bestIdx >= 0) {
            $(table.cell(bestIdx, col).node()).addClass('best-score');
          }
        }
      });

      $('#resetHighlights').on('click', function () {
        $('.best-score').removeClass('best-score');
        $('.highlight-row').removeClass('highlight-row');
      });

      $('#modelTable tbody').on('click', 'tr.group-row', function () {
        $(this).toggleClass('highlight-row');
      });
    }
  </script>
</body>
</html>
