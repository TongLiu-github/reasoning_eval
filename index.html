<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Math Model Leaderboard</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .group-header {
      font-weight: bold;
      background-color: #e5e7eb !important;
      text-align: left;
    }
    .highlight-row {
      background-color: #fef3c7 !important;
    }
    .model-name {
      font-weight: 500;
    }
    .best-score {
      font-weight: bold;
      color: #047857;
    }
    .dataTables_wrapper .dataTables_filter {
      float: none;
      text-align: left;
      margin-bottom: 1rem;
    }
    .dataTables_wrapper .dataTables_length,
    .dataTables_wrapper .dataTables_filter {
      margin-bottom: 1rem;
    }
    .dataTables_wrapper .dataTables_info {
      padding-top: 0.5rem;
    }
    #groupFilterContainer {
      margin-bottom: 1rem;
    }
  </style>
</head>
<body class="bg-white text-gray-900 p-6">
  <div class="max-w-7xl mx-auto">
    <h1 class="text-3xl font-bold mb-6">Sober Reasoning Leaderboard</h1>

    <div class="mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
      <button id="toggleCaption" class="mb-2 px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 text-sm">Show caption</button>
      <div id="caption" class="text-sm text-gray-700 hidden">
        Evaluation details: Pass@1 accuracy across six math benchmarks under a unified evaluation pipeline.
      </div>
    </div>

    <div class="flex flex-col md:flex-row mb-6 gap-4">
      <div id="groupFilterContainer" class="md:w-1/2">
        <label for="groupFilter" class="block text-sm font-medium text-gray-700 mb-1">Filter by Model Group:</label>
        <select id="groupFilter" class="border border-gray-300 rounded px-3 py-2 w-full">
          <option value="">All model groups</option>
        </select>
      </div>
    </div>

    <div class="mb-4 flex flex-wrap gap-2">
      <button id="highlightBest" class="px-3 py-1 bg-blue-100 text-blue-800 rounded hover:bg-blue-200 text-sm">Highlight Best Scores</button>
      <button id="resetHighlights" class="px-3 py-1 bg-gray-100 text-gray-800 rounded hover:bg-gray-200 text-sm">Reset Highlights</button>
    </div>

    <div class="overflow-x-auto shadow-md rounded-lg">
      <table id="modelTable" class="display stripe w-full text-sm">
        <thead>
          <tr>
            <th>Model Name</th>
            <th>Organization</th>
            <th>Based on</th>
            <th>Paper Link</th>
            <th>AIME'24</th>
            <th>AIME'25</th>
            <th>AMC'23</th>
            <th>MATH500</th>
            <th>Minerva</th>
            <th>Olympiad</th>
            <th>Average</th>
          </tr>
        </thead>
        <tbody id="modelBody">
          <!-- Auto-filled by JS -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
$(document).ready(function () {
  $.getJSON("data.json", function(modelData) {
    const tbody = $("#modelBody");
    const groups = new Set();

    modelData.forEach(model => {
      groups.add(model.basedOn);
      const row = $("<tr>").addClass("group-row").attr("data-group", model.basedOn);
      row.append(`<td class="model-name">${model.name}</td>`);
      row.append(`<td>${model.org}</td>`);
      row.append(`<td>${model.basedOn}</td>`);
      row.append(`<td><a href="${model.paper}" target="_blank">Link</a></td>`);
      model.scores.forEach(score => row.append(`<td>${score}</td>`));
      tbody.append(row);
    });

    // Fill filter dropdown
    groups.forEach(group => {
      $("#groupFilter").append(`<option value="${group}">${group}</option>`);
    });

    initTable();
  });

  function initTable() {
    const table = $('#modelTable').DataTable({
      columnDefs: [
        { targets: [2], visible: false },
        {
          targets: [4, 5, 6, 7, 8, 9, 10],
          render: function (data, type) {
            if (type === 'sort' || type === 'type') {
              return parseFloat(data.split('±')[0]);
            }
            return data;
          }
        }
      ],
      order: [[2, 'asc'], [10, 'desc']],
      rowGroup: {
        dataSrc: 2,
        startRender: function (rows, group) {
          return $('<tr class="group-header"/>')
            .append(`<td colspan="10">Based on: ${group}</td>`);
        }
      },
      paging: false,
      info: true,
      ordering: true,
      searching: true
    });

    $('#groupFilter').on('change', function () {
      const val = $(this).val();
      table.column(2).search(val, true, false).draw();
    });

    $('#highlightBest').on('click', function () {
      $('.best-score').removeClass('best-score');
      for (let col = 4; col <= 9; col++) {
        let bestScore = -1;
        let bestIdx = -1;
        table.rows({ search: 'applied' }).every(function (idx) {
          const score = parseFloat(this.data()[col].split('±')[0]);
          if (!isNaN(score) && score > bestScore) {
            bestScore = score;
            bestIdx = idx;
          }
        });
        if (bestIdx >= 0) {
          $(table.cell(bestIdx, col).node()).addClass('best-score');
        }
      }
    });

    $('#resetHighlights').on('click', function () {
      $('.best-score').removeClass('best-score');
      $('.highlight-row').removeClass('highlight-row');
    });

    $('#modelTable tbody').on('click', 'tr.group-row', function () {
      $(this).toggleClass('highlight-row');
    });

    $('#toggleCaption').on('click', function () {
      $('#caption').toggleClass('hidden');
      $(this).text($('#caption').hasClass('hidden') ? 'Show caption' : 'Hide caption');
    });
  }
});

  </script>
</body>
</html>
